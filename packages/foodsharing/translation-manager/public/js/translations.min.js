function swapInClass(t,e,n){"use strict";return t.removeClass(n).addClass(e)}function swapOutClass(t,e,n){"use strict";return t.removeClass(e).addClass(n)}function swapClass(t,e,n,a){"use strict";return e?swapInClass(t,n,a):swapOutClass(t,n,a)}function translateYandex(t,e,n,a){var s=200,i=401,l=402,r=403,o=404,c=413,d=422,u=501,b={200:"Operation completed successfully.",401:"Invalid API key.",402:"This API key has been blocked.",403:"You have reached the daily limit for requests (including calls of the detect method).",404:"You have reached the daily limit for the volume of translated text (including calls of the detect method).",413:"The text size exceeds the maximum.",422:"The text could not be translated.",501:"The specified translation direction is not supported."},p=$.getJSON("https://translate.yandex.net/api/v1.5/tr.json/translate",{key:YANDEX_TRANSLATOR_KEY,lang:t+"-"+n,text:e},function(t){t.code===s?a(t.text.join("\n")):window.console.log("Yandex API: "+t.code+": "+b[t.code]+"\n")});p.done(function(){}),p.fail(function(){})}function startsWithWord2(t,e,n){return 0===e.toLocaleLowerCase().indexOf(n)&&0!==t.toLocaleLowerCase().indexOf(n)}function extractSecondWord(t){var e,n,a=t.indexOf(" ");return-1!==a&&(e=t.substr(0,a),n=t.substr(a+1),t=startsWithWord2(e,n,"од")||startsWithWord2(e,n,"дв")||startsWithWord2(e,n,"пя")?e:n),t}function extractPluralForm(t,e){return t.length>e?extractSecondWord(t[e]):""}var CLIP_TEXT,MISSMATCHED_QUOTES_MESSAGE,YANDEX_TRANSLATOR_KEY,URL_YANDEX_TRANSLATOR_KEY,PRIMARY_LOCALE,CURRENT_LOCALE,TRANSLATING_LOCALE,xtranslateText,xtranslateService,MARKDOWN_KEY_SUFFIX,TITLE_SAVE_CHANGES,TITLE_CANCEL_CHANGES,TITLE_TRANSLATE,TITLE_CONVERT_KEY,TITLE_GENERATE_PLURALS,TITLE_CLEAN_HTML_MARKDOWN,TITLE_CAPITALIZE,TITLE_LOWERCASE,TITLE_CAPITALIZE_FIRST_WORD,TITLE_SIMULATED_COPY,TITLE_SIMULATED_PASTE,TITLE_RESET_EDITOR,TITLE_LOAD_LAST;String.prototype.toCapitalCase=function(){"use strict";return this.toLowerCase().replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})},String.prototype.toLocaleCapitalCase=function(){"use strict";return this.toLocaleLowerCase().replace(/(?:^|\s)\S/g,function(t){return t.toLocaleUpperCase()})},String.prototype.toLocaleProperCase=function(){"use strict";return this.toLocaleLowerCase().replace(/(?:^)\S/,function(t){return t.toLocaleUpperCase()})},String.prototype.toLocaleProperCaseOrLowerCase=function(){"use strict";return this.substr(0,1)+this.substr(1).toLocaleLowerCase()},xtranslateService=translateYandex,xtranslateText=function(t,e,n,a,s){var i,l,r,o,c=n;-1!==(i=n.indexOf("|"))&&(l=n.substr(0,i),r=n.substr(i+1),c="one "+l+"\ntwo "+r+"\nfive "+r,o=!0);for(var d=0,u=[],b,p,h=/\:([a-zA-Z0-9_-]*)(?=[^a-zA-Z0-9_-]|$)/g,f="",T=0;null!==(p=h.exec(c));){var E=p[1];(T=u.indexOf(E)+1)||(u.push(E),T=u.length),f+=c.substr(d,p.index-d),f+="{{"+T+"}}",d=h.lastIndex}T&&(f+=c.substr(d,c.length),c=f),t(e,c,a,function(t){var e,n,i,l,r,c=/\{\{[0-9]*\}\}/g;T&&(t=t.replace(c,function(t){return":"+u[parseInt(t.substr(2,t.length-4))-1]})),o&&(r=t.replace(/$\s*/gm,"|"),"|"===r.substr(r.length-1,1)&&(r=r.substr(0,r.length-1)),l=t.split("\n",3),e=extractPluralForm(l,0),n=extractPluralForm(l,1),"ru"===a?(i=extractPluralForm(l,2),t=e+"|"+n+"|"+i):t=e+"|"+n),s(t,r)})},$(document).ready(function(){"use strict";function t(t){for(var e=/\b(href=|src=)\s*("|')?([^"'>]*)("|')?/,n=/:string/g,a=MISSMATCHED_QUOTES_MESSAGE||"mismatched or missing quotes in :string attribute",s=[],i=0,l,r,o=t,c=t.length,d;(c>i&&-1!==(l=o.indexOf("href=",i))||-1!==(l=o.indexOf("src=",i)))&&(i=l,o=o.substr(i>0?i-1:0),r=o.match(e));)(void 0===r[2]||r[2]!==r[4])&&s.push(a.replace(n,r[0])),i+=r[0].length;return s.length?(d=$(".editableform .editable-error-block"),d.length&&window.setTimeout(function(){d.html(o)},50),o="<ul><li>"+s.join("</li><li>")+"</li></ul>"," "):void 0}function e(t){var e;if(void 0!==document.selection){t.focus();var n=document.selection.createRange();return e=n.text}if(void 0!==t.selectionStart){var a=t.selectionStart,s=t.selectionEnd;return e=t.value.substring(a,s)}}var n;$.ajaxPrefilter(function(t){t.crossDomain||(t.headers={"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")})}),URL_YANDEX_TRANSLATOR_KEY&&$.ajax({type:"POST",url:URL_YANDEX_TRANSLATOR_KEY,data:{},success:function(t){"ok"===t.status&&(YANDEX_TRANSLATOR_KEY=t.yandex_key)},encode:!0}),$.fn.editableContainer.defaults.placement="top",$.fn.editableContainer.defaults.onblur="submit",$.fn.editableContainer.defaults.validate=function(e){return t(e)},$.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"> <div>  <div class="editable-buttons" style="display: block"></div>  <div id="x-trans-edit" class="editable-input"></div>  <div class="editable-error-block"></div> </div></div></form>';var a=TITLE_SAVE_CHANGES||"Save changes",s=TITLE_CANCEL_CHANGES||"Cancel changes",i=TITLE_TRANSLATE||"Translate",l=TITLE_CONVERT_KEY||"Convert translation key to text",r=TITLE_GENERATE_PLURALS||"Generate plural forms",o=TITLE_CLEAN_HTML_MARKDOWN||"Clean HTML markdown",c=TITLE_CAPITALIZE||"Capitalize text",d=TITLE_LOWERCASE||"Lowercase text",u=TITLE_CAPITALIZE_FIRST_WORD||"Capitalize first word",b=TITLE_SIMULATED_COPY||"Copy text to simulated clipboard (page refresh clears contents)",p=TITLE_SIMULATED_PASTE||"Paste text from simulated clipboard",h=TITLE_RESET_EDITOR||"Reset editor contents",f=TITLE_LOAD_LAST||"Load last published/imported value";$.fn.editableform.buttons='<button type="submit" title="'+a+'" id="x-submit" class="editable-submit btn btn-sm btn-success"><i class="glyphicon glyphicon-ok"></i></button>&nbsp;<button type="button" title="'+s+'" id="x-cancel" class="editable-cancel btn btn-sm btn-danger"><i class="glyphicon glyphicon-remove"></i></button>&nbsp;&nbsp;<button id="x-translate" type="button" title="'+i+'" class="editable-translate btn btn-sm btn-warning hidden"><i class="glyphicon glyphicon-share-alt"></i></button><button id="x-nodash" type="button" title="'+l+'" class="editable-translate btn btn-sm btn-warning hidden">❉ <i class="glyphicon glyphicon-share-alt"></i> Ab</button>&nbsp;&nbsp;<button id="x-plurals" type="button" title="'+r+'" class="editable-translate btn btn-sm btn-warning hidden">|</i></button><button id="x-clean-markdown" type="button" title="'+o+'" class="editable-translate btn btn-sm btn-warning hidden"><i class="glyphicon glyphicon-flash"></i></button>&nbsp;&nbsp;<button id="x-capitalize" type="button" title="'+c+'" class="editable-translate btn btn-sm btn-info">ab <i class="glyphicon glyphicon-share-alt"></i> Ab</button><button id="x-lowercase" type="button" title="'+d+'" class="editable-translate btn btn-sm btn-info">AB <i class="glyphicon glyphicon-share-alt"></i> ab</button><button id="x-propcap" type="button" title="'+u+'" class="editable-translate btn btn-sm btn-info">A B <i class="glyphicon glyphicon-share-alt"></i> A b</button>&nbsp;&nbsp;<button id="x-copy" type="button" title="'+b+'" class="editable-translate btn btn-sm btn-primary"><i class="glyphicon glyphicon-copy"></i></button><button id="x-paste" type="button" title="'+p+'" class="editable-translate btn btn-sm btn-primary"><i class="glyphicon glyphicon-paste"></i></button>&nbsp;&nbsp;<button id="x-reset-open" type="button" title="'+h+'" class="editable-translate btn btn-sm btn-success"><i class="glyphicon glyphicon-open"></i></button><button id="x-reset-saved" type="button" title="'+f+'" class="editable-translate btn btn-sm btn-success"><i class="glyphicon glyphicon-floppy-open"></i></button><br>&nbsp;',$.fn.editableform.formElements=function(t){var e=$(t).find("+ div.editable-container");return e.length>0?{elemInput:e.find("#x-trans-edit").first().find("textarea.editable-input").first(),elemError:e.find(".editable-error-block").first(),btnTranslate:e.find("#x-translate").first(),btnCapitalize:e.find("#x-capitalize").first(),btnLowercase:e.find("#x-lowercase").first(),btnPlurals:e.find("#x-plurals").first(),btnPropCap:e.find("#x-propcap").first(),btnNoDash:e.find("#x-nodash").first(),btnCopy:e.find("#x-copy").first(),btnPaste:e.find("#x-paste").first(),btnResetOpen:e.find("#x-reset-open").first(),btnResetSaved:e.find("#x-reset-saved").first(),btnCleanMarkdown:e.find("#x-clean-markdown").first()}:null};var T,E,g,L,C,_=0,A=function(t,e,n,a,s){return function(){xtranslateText(xtranslateService,t,e,n,function(t,e){e&&(s.html(e),s.css("display","block")),a.val(t),a.focus()})}},m=function(t,n,a){return function(){var s=e(t[0]);s?t.selection("replace",{text:n.apply(s,a)}):t.val(n.apply(t.val(),a)),t.focus()}},v=function(t,n,a){return function(){var s=e(t[0]);if(s)t.selection("replace",{text:n.apply(s,a)});else{var i;-1!==t.val().indexOf("|")?(i=t.val().split("|"),i.forEach(function(t,e,s){s[e]=n.apply(t,a)}),t.val(i.join("|"))):t.val(n.apply(t.val(),a))}t.focus()}},y=function(t,e,n){return function(){t.val(e.apply(t.val(),n)),t.focus()}};$.fn.fstrans_editable=function(t){var e={},n=$.extend({},e,t);this.each(function(){var t=$(this),e=t.offset().top;300>e?t.editable({placement:"bottom"}):t.editable({placement:"top"}),t.editable().off("hidden"),t.editable().on("hidden.fstrans",function(t,e){var n=$(this).data("locale"),a=$(this).parents("tr").first(),s=a.find("a.fstrans_editable"),i;"save"===e&&$(this).removeClass("status-0").addClass("status-1"),(i=s.filter(".editable-empty").length)?(a.addClass("has-empty-translation"),i===s.length?a.removeClass("has-nonempty-translation"):a.addClass("has-nonempty-translation")):(a.removeClass("has-empty-translation"),a.addClass("has-nonempty-translation")),s.filter(".status-1").length?a.addClass("has-changed-translation"):a.removeClass("has-changed-translation"),--_||$(".editing").removeClass("editing")}),t.editable().off("shown"),t.editable().on("shown.fstrans",function(t,e){var n,a,s,i=$(this).data("saved_value"),l,r=$(this).attr("id"),o=/-|_/g,c;g=$(this).data("locale"),E=g===PRIMARY_LOCALE?"":PRIMARY_LOCALE,_++,a=E+r.substr(g.length),n=r.substr(g.length+1),C=$("tr#"+n.replace(/\./,"-")).first(),c=n.replace(o," ").toCapitalCase();var d=$.fn.editableform.formElements(this);L=d.elemInput,l=L[0].value.trim(),L[0].value=l,void 0!==MARKDOWN_KEY_SUFFIX&&""!==MARKDOWN_KEY_SUFFIX&&n.length>MARKDOWN_KEY_SUFFIX.length&&n.substring(n.length-MARKDOWN_KEY_SUFFIX.length,n.length)===MARKDOWN_KEY_SUFFIX?d.btnCleanMarkdown.length&&(d.btnCleanMarkdown.removeClass("hidden"),d.btnCleanMarkdown.on("click",m(L,function(t){for(var e=this,n=e.split("\n"),a=n.length,s="",i=!0,l=0;a>l;l++){var r=n[l],o=!1;if(0===r.trim().length)i?(r="",o=i):(r="\n",o=!0);else if(o=!1,r.length>2&&"  "===r.substring(r.length-2,r.length))r+="\n";else if((l+1>=a||0===n[l+1].trim().length)&&(r+="\n"),s.length>0){var c=s.charAt(s.length-1);"\n"!==c&&" "!==c&&" "!==r.charAt(0)&&(s+=" ")}s+=r,i=o}return s}))):d.btnPlurals.length&&(g===PRIMARY_LOCALE||""!==YANDEX_TRANSLATOR_KEY)&&(d.btnPlurals.removeClass("hidden"),d.btnPlurals.on("click",y(L,function(){var t=this;if(-1===t.indexOf("|")){switch(g){case"ru":t=this+"|"+this+"|"+this;break;case"en":t="en"===PRIMARY_LOCALE?c.singularize()+"|"+c.pluralize():t.singularize()+"|"+t.pluralize();break;default:t=this+"|"+this}return t.toLocaleLowerCase()}return t}))),C.length&&($(".editing").removeClass("editing"),C.addClass("editing")),d.btnTranslate.length&&L.length&&""!==YANDEX_TRANSLATOR_KEY&&""!==E&&(s=C.find("#"+a.replace(/\./,"-")).first(),s.length&&(T=s.text(),d.btnTranslate.html(E+' <i class="glyphicon glyphicon-share-alt"></i> '+g),d.btnTranslate.removeClass("hidden"),d.btnTranslate.on("click",A(E,T,g,L,d.elemError)))),d.btnNoDash.length&&g===PRIMARY_LOCALE&&(d.btnNoDash.removeClass("hidden"),d.btnNoDash.on("click",y(L,function(){return c}))),d.btnCapitalize.length&&d.btnCapitalize.on("click",v(L,String.prototype.toLocaleCapitalCase)),d.btnLowercase.length&&d.btnLowercase.on("click",m(L,String.prototype.toLocaleLowerCase)),d.btnPropCap.length&&d.btnPropCap.on("click",m(L,String.prototype.toLocaleProperCase)),d.btnCopy.length&&d.btnCopy.on("click",m(L,function(){return CLIP_TEXT=this,this})),d.btnPaste.length&&d.btnPaste.on("click",m(L,function(){return CLIP_TEXT})),d.btnResetOpen.length&&d.btnResetOpen.on("click",y(L,function(){return l})),d.btnResetSaved.length&&d.btnResetSaved.on("click",y(L,function(){return i}))})})},$(".fstrans_editable").fstrans_editable()});